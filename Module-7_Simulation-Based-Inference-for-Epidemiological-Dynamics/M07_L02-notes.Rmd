---
title: 'Module 7: Lesson 2 Notes'
author: "Callum Arnold"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Simulation of stochastic dynamic models

## Compartmental model (SIR)

-   Represented by flows between compartments

    -   Specify rates

-   Use a more generalized structure/notation as more flexible for later

![](images/Screen%20Shot%202021-07-11%20at%206.47.57%20PM.png){width="526"}

-   Here, the recovery rate $\mu_{IR}$ is constant, but the infection rate
    $\mu_{SI}(t) = \beta I(t)$ with $\beta$ being the **contact rate**

-   In the simplest form without demography, set all birth and death rates to 0

-   Useful to track the cumulative number of individuals who transition between
    compartments

    -   E.g. $N_{SI}(t)$ is the cumulative number of individuals from $S$ to $I$
        by time $t$

        -    Is a **counting process**

    -    Always non-decreasing in compartmental models

    -   Integer valued in discrete time, real valued in continuous time

-   Rewrite our standard equations using the counting processes:

$$
\begin{aligned}
S(t) &= S(0) - N_{SI}(t) \\
I(t) &= I(0) + N_{SI}(t) - N_{IR}(t) \\
R(t) &= R(0) + N_{IR}(t)
\end{aligned}
$$

### Differential equation representation (deterministic approach)

-   Can write analogous ODEs:

    -   Note that the rates are defined *per capita*, rather than overall, hence
        the need to multiple by the compartment

$$
\begin{aligned}
\frac{dN_{SI}}{dt} &= \mu_{SI}(t) S(t) \\
\frac{dN_{IR}}{dt} &= \mu_{IR}(t) I(t)
\end{aligned}
$$

### Continuous time Markov representation (stochastic approach)

-   This can be modified into a continuous-time Markov chain model

    -   Markov chain allows model to be specified from transition probabilities
        along with initial conditions

        -   Defined within a small time interval ($t \to t+\delta$) and valid in
            the limit $\lim_{\delta \to 0} \frac{h(\delta)}{\delta} = 0$

$$
\begin{aligned}
\Pr [ N_{SI}(t + \delta) = N_{SI}(t) + 1] &= \mu_{SI}(t)S(t)\delta + o(\delta) \\
\Pr [ N_{SI}(t + \delta) = N_{SI}(t)] &= 1 - \mu_{SI}(t)S(t)\delta + o(\delta)
\end{aligned}
$$

-   This is the chance of the event that exactly one person moves from $S$ to
    $I$ in the time interval $t \to t+\delta$

    -   $o(\delta)$ turns it into a probability

        -   $h(\delta) = o(\delta) \text{ to mean } \lim_{\delta \to 0} \frac{h(\delta)}{\delta} = 0$

### Simple counting processes

-   Assumption in making link between differential equation and Markov form

-   A simple counting process can only count one event at a time

-   Has limitation for what it can model

    -   May want to add randomness from multiple simultaneous events e.g.
        someone sneezing in a bus

# Euler's method

## Numerical solution of deterministic dynamics

-   Want to be able to get an approximation $\tilde{x}(t)$ of $x(t)$ for when
    you can't solve an ODE analytically.

    -   The gradient $dx/dt$ can be analytically computed and is approximately
        constant over a small time interval ($k\delta \le t \le (k + 1)\delta$),
        therefore, multiply the gradient by the time interval to get the
        approximation of the new value of $x(t)$

        -   $\tilde{x}\left((k+1)\delta \right) = \tilde{x}(k\delta) + \delta h\left(\tilde{x}(k\delta)\right)$

        -   Note that $\tilde{x}(t)$ is only defined when $t$ is a multiple of
            $\delta$ (not defined continuously)

    -   
